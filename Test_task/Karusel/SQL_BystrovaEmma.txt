Задача 1

Select
CLIENT,
LAST_STORE,
STORES_VISITED_NUM
From (SELECT 
    CLIENT,
    count(HYPERMARKET) as STORES_VISITED_NUM 
    FROM table 
    group by CLIENT) AS l
JOIN (
SELECT 
CLIENT,
HYPERMARKET as LAST_STORE
FROM table
WHERE 
DATEC IN (SELECT MAX(DATEC)
FROM table group by CLIENT)
GROUP BY 
CLIENT,
LAST_STORE) AS r
ON l.CLIENT = r.CLIENT

Задача 2

(SELECT DISTINCT l.CLIENT 
FROM A_1 AS l
LEFT ANTI JOIN A_2 AS r ON l.CLIENT = r.CLIENT 
)
UNION ALL
(SELECT DISTINCT r.CLIENT  
FROM A_1 AS l
RIGHT ANTI JOIN A_2 AS r ON  l.CLIENT = r.CLIENT  
)